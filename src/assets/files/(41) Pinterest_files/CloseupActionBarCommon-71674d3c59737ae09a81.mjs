(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["CloseupActionBarCommon"],{"0kFJ":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("nKUr"),o=n("q1tI"),r=n("c4Fo"),s=n("n6mq");class a extends o.Component{constructor(...e){var t,n,i;super(...e),i={paused:!1,showPulsar:!1},(n="state")in(t=this)?Object.defineProperty(t,n,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[n]=i}componentDidMount(){this.mountPulsar(),this.props.onExperienceMount&&this.experience&&this.props.onExperienceMount(this.experience)}componentWillUnmount(){clearTimeout(this.timer)}mountPulsar(){if(!this.experience)return;const{display_data:e}=this.experience;e.has_pulsar&&this.setState({showPulsar:!0})}renderPulsar(){const{anchor:e}=this.props,{paused:t}=this.state;if(!e)return null;const n=e.getBoundingClientRect(),{height:o,width:r}=n,a=-(68+o/2),c=-(68-r/2);return Object(i.jsx)(s.e,{position:"absolute",dangerouslySetInlineStyle:{__style:{zIndex:1,marginTop:a,marginLeft:c,cursor:"pointer",pointerEvents:"none"}},children:Object(i.jsx)(s.I,{paused:t})})}renderFlyout(e){const{anchor:t,flyoutSize:n,idealDirection:o,textOverflow:r}=this.props;return Object(i.jsx)(s.s,{anchor:t,color:"blue",idealDirection:o||"down",onDismiss:()=>{},shouldFocus:!1,showCaret:!0,size:n,children:Object(i.jsx)(s.e,{column:12,padding:3,children:Object(i.jsx)(s.W,{color:"white",overflow:r,weight:"bold",children:e})})})}render(){const{experienceIds:e,placementId:t,shouldTimeoutDismiss:n}=this.props,{showPulsar:o}=this.state;return Object(i.jsx)(r.a,{experienceIds:e,placementId:t,type:8,children:e=>{const{complete:t,dismiss:r,display_data:a}=e;return this.experience=e,a.has_pulsar||a.has_tooltip?(n&&a.disappearTime&&a.disappearTime>0&&(this.timer=setTimeout(()=>(r(),null),a.disappearTime)),Object(i.jsxs)(s.e,{dangerouslySetInlineStyle:{__style:{zIndex:10}},children:[o&&this.renderPulsar(),a.has_tooltip&&(!a.has_pulsar||this.state.paused)&&this.renderFlyout(a.text)]})):(t(),null)}})}}},qlIy:function(e,t,n){n.r(t),n.d(t,"CloseupActionBar",(function(){return L}));var i=n("nKUr"),o=n("q1tI"),r=n("/MKj"),s=n("UAdG"),a=n("n6mq"),c=n("HJ6M"),l=n("Wer7"),d=n("U4JR"),u=n("tuD4");function h({board:e,favorited:t,pinId:n,section:o}){const h=Object(r.useDispatch)(),p=null==e?void 0:e.eligible_pin_type_filters,m=null==o?void 0:o.eligible_pin_type_filters,b=Object(u.a)(p,c.b),j=Object(u.a)(m,c.b);let f,y;e&&([f,y]=Object(u.b)(e.url));const g=e=>{Object(d.b)(101,{component:13791,element:e?12225:12226,objectId:n,view:3})};return Object(i.jsx)(a.e,{paddingX:3,children:Object(i.jsx)(s.a,{favorited:t,onFavorite:()=>{g(!0),b&&h(Object(l.f)("BoardResource",{username:y,slug:f,field_set_key:"detailed"})),j&&h(Object(l.f)("BoardSectionResource",{board_slug:f,section_slug:null==o?void 0:o.slug,username:y}))},onUnfavorite:()=>{g(!1)},pinId:n,size:24})})}var p=n("OPV1"),m=n("6wCo"),b=n("0kFJ"),j=n("1Vso");const f="cubic-bezier(0, 0, 0.58, 1)",y={loaded:{opacity:1,transitionDuration:"0.20s",transitionTimingFunction:f,transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"},fade:{opacity:.1,transitionDuration:"0.30s",transitionTimingFunction:f,transitionProperty:"transform, opacity",transform:"translate(0, 5px)",transformOrigin:"center"}};function g({reactionLabel:e,handleHideConfirmation:t}){const[n,r]=Object(o.useState)("loaded"),s=Object(o.useRef)();return Object(o.useEffect)(()=>{let e=null,n=null;return s.current=requestAnimationFrame(()=>{e=setTimeout(()=>r("fade"),1e3),n=setTimeout(()=>t(),1300)}),function(){clearTimeout(e),clearTimeout(n)}},[]),Object(i.jsx)(a.e,{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",children:Object(i.jsx)(a.e,{rounding:"pill",position:"absolute",color:"darkGray",ref:s,height:20,display:"flex",alignItems:"center",justifyContent:"center",paddingY:1,paddingX:2,dangerouslySetInlineStyle:{__style:{...y[n],whiteSpace:"nowrap"}},children:Object(i.jsx)(a.W,{color:"white",size:"sm",weight:"bold",overflow:"normal",children:e})})})}var O=n("ihsa"),x=n("eo+c");const S=40,v={icon:{backgroundRepeat:"no-repeat",backgroundSize:"cover"},loading:{opacity:0,transitionDuration:"0.25s",transitionTimingFunction:"ease-out",transitionProperty:"transform, opacity",transform:"scaleX(1) scaleY(1) translateZ(0) translateY(25px)",transformOrigin:"bottom"},loaded:{opacity:1,transitionDuration:"0.2s",transitionTimingFunction:"ease-out",transitionProperty:"transform, opacity",transform:"scaleX(1) scaleY(1)",transformOrigin:"bottom"},clicked:{transition:"transform 0.2s ease-out",transform:"translateY(-30px) scaleX(1.6) scaleY(1.6)",transformOrigin:"bottom",position:"relative",zIndex:1},flying:{transition:"transform 0.2s ease-out",transformOrigin:"bottom"},label:{transition:"transform 0.2s ease-out",transform:"scale(0.625)",transformOrigin:"bottom",whiteSpace:"nowrap"},fading:{opacity:0,transition:"opacity 0.2s ease-out"}},R={boxShadow:"0 9px 26px rgba(0, 0, 0, 0.4)"};function T({reactionButtonRect:e,handleReactionTrayClick:t}){const[n,r]=Object(o.useState)("loading"),[s,c]=Object(o.useState)(""),[l,d]=Object(o.useState)(),[u,h]=Object(o.useState)(!1),[p,m]=Object(o.useState)({}),[b]=Object(o.useState)(e),j=Object(o.useRef)(),f=Object(o.useRef)({});Object(o.useEffect)(()=>{"loading"===n&&(j.current=requestAnimationFrame(()=>r("loaded"))),(()=>{h(!0);const e={...p};x.c.forEach(t=>{f.current[t]&&!e[t]&&(e[t]=f.current[t].getBoundingClientRect())}),Object.keys(e).length===x.c.length&&m(e)})(),!l&&u&&(()=>{const e={...l};x.c.forEach(t=>{const n=p[t],{left:i,top:o}=b,{left:r,top:s}=n,a=i-r-8,c=o-s+9;e[t]={translateX:a,translateY:c}}),d(e)})()},[u,e]);const y=()=>{"clicked"===n&&s&&(r("flying"),setTimeout(()=>{t(s)},750))},g=x.c.map((e,t)=>{const{staticAsset:o,animatedAsset:r,label:c,htmlStyle:d,animationStyle:u}=Object(x.a)(e),h={transitionDelay:.08*t+"s",...v[n]},p={...s===e?v.clicked:v.loaded},m={...l&&s===e?{transform:`translateZ(0) translateX(${l[e].translateX}px) translateY(${l[e].translateY}px) scaleX(0.6) scaleY(0.6) `,...v[n]}:v.fading};let b={};return"loading"===n||"loaded"===n?b={...h}:"clicked"===n?b={...p}:"flying"===n&&(b={...m}),Object(i.jsx)(a.e,{display:"flex",alignSelf:"center",justifyContent:"between",children:Object(i.jsxs)(a.e,{maxHeight:S,maxWidth:S,display:"flex",alignItems:"center",justifyContent:"center",position:"relative",dangerouslySetInlineStyle:{__style:{...b}},ref:t=>{f.current[e]=t},children:[s!==e&&Object(i.jsx)(a.e,{position:"absolute",top:!0,left:!0,bottom:!0,right:!0,children:Object(i.jsx)(a.e,{width:S,height:S,dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${o})`,backgroundPosiiton:"center",backgroundRepeat:"no-repeat",backgroundSize:"cover"}}})}),Object(i.jsxs)(a.e,{display:"flex",alignItems:"center",justifyContent:"center",direction:"column",position:"relative",children:[Object(i.jsx)(O.a,{unsafeCSS:d}),s===e&&"clicked"===n&&Object(i.jsx)(a.e,{rounding:"pill",color:"darkGray",height:20,dangerouslySetInlineStyle:{__style:v.label},display:"flex",alignItems:"center",justifyContent:"center",paddingY:1,paddingX:2,children:Object(i.jsx)(a.W,{color:"white",size:"sm",weight:"bold",overflow:"normal",children:c})}),Object(i.jsx)("div",{onClick:y,onKeyDown:y,role:"presentation",children:Object(i.jsx)(a.e,{width:S,height:S,display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{...v.icon,...s===e&&"clicked"===n?{animation:u}:{},backgroundImage:`url(${r})`}}})})]})]})},t)});return Object(i.jsx)(a.e,{position:"absolute",display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{marginLeft:-150}},children:Object(i.jsx)(a.e,{display:"flex",alignItems:"center",justifyContent:"center",width:300,height:80,rounding:"pill",color:"flying"===n?"transparent":"white",dangerouslySetInlineStyle:{__style:{..."flying"!==n?R:{}}},onMouseMove:e=>{const{clientX:t}=e;if("flying"!==n){const e=(e=>{let t;return u&&x.c.forEach(n=>{const i=p[n];if(i&&i.left&&i.right){const{left:o,right:r}=i;e>=o&&e<=r&&(t=n)}}),t||null})(t);e!==s&&c(e),r("clicked")}},children:Object(i.jsx)(a.e,{display:"flex",alignItems:"center",justifyContent:"around",width:"100%",paddingX:5,children:g})})})}var _=n("eOdZ");function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const C={borderRadius:"50%"},I={backgroundColor:"rgb(226, 226, 226)"},B={backgroundColor:"rgb(218, 218, 218)"},k={boxShadow:"0 0 0 4px rgba(0, 132, 255, 0.5)",outline:0};class E extends o.PureComponent{constructor(...e){super(...e),w(this,"state",{clickedReaction:0,isConfirmationShowing:!1,isReactionTrayShowing:!1,reactionButtonRect:null,useInitialReaction:!0,isHoveringOverTray:!1,isHoveringOverButton:!1}),w(this,"reactionButtonRef",Object(o.createRef)()),w(this,"trayOpenTimer",null),w(this,"trayCloseTimer",null),w(this,"onResize",()=>{this.setReactionButtonRect(),this.startTrayCloseTimer()}),w(this,"onScroll",()=>{this.setReactionButtonRect(),this.startTrayCloseTimer()}),w(this,"handleExperienceMount",e=>{e&&e.complete&&(501977===e.experience_id||501995===e.experience_id)&&(this.tooltipExperience=e)}),w(this,"handleReact",(e=7)=>{const{pinId:t,pinUpdateReactionCount:n}=this.props,i={pin_id:t,reaction_type:e},{clickedReaction:o}=this.state;o&&n(t,!1,o),this.setState({clickedReaction:e,useInitialReaction:!1}),n(t,!0,e),_.a.create("ReactionsResource",i).callUpdate()}),w(this,"handleUnreact",()=>{const{pinId:e}=this.props,t={pin_id:e};this.setState({clickedReaction:0,useInitialReaction:!1}),_.a.create("ReactionsResource",t).callDelete()}),w(this,"setReactionButtonRect",()=>{if(this.reactionButtonRef.current&&this.reactionButtonRef.current instanceof HTMLElement){const e=this.reactionButtonRef.current.getBoundingClientRect();this.setState({reactionButtonRect:e})}}),w(this,"closeTray",()=>{this.setState({isReactionTrayShowing:!1})}),w(this,"startTrayCloseTimer",()=>{clearTimeout(this.trayCloseTimer),this.trayCloseTimer=setTimeout(()=>{const{isHoveringOverTray:e,isHoveringOverButton:t}=this.state;e||t||this.closeTray()},300)}),w(this,"handleOnHoverButton",()=>{this.setState({isHoveringOverButton:!0}),clearTimeout(this.trayOpenTimer),this.trayOpenTimer=setTimeout(()=>{const{isReactionTrayShowing:e,isHoveringOverButton:t}=this.state;!e&&t&&this.setState({isReactionTrayShowing:!0})},500),this.tooltipExperience&&this.tooltipExperience.complete&&this.tooltipExperience.complete()}),w(this,"handleOffHoverButton",()=>{this.setState({isHoveringOverButton:!1}),this.startTrayCloseTimer()}),w(this,"handleOnHoverTray",()=>{this.setState({isHoveringOverTray:!0})}),w(this,"handleOffHoverTray",()=>{this.setState({isHoveringOverTray:!1}),this.startTrayCloseTimer()}),w(this,"handleClickButton",()=>{const{clickedReaction:e,useInitialReaction:t}=this.state,{pinId:n,pinUpdateReactionCount:i,reactionByMe:o}=this.props,r=t?o:e;r?(i(n,!1,r),this.handleUnreact()):this.setReaction("love"),clearTimeout(this.trayOpenTimer),this.closeTray(),Object(d.b)(101,{view:3,viewParameter:139,element:11354,objectId:n})}),w(this,"setReaction",e=>{this.handleReact(Object(x.a)(e).type),this.handleShowConfirmation()}),w(this,"handleShowConfirmation",()=>{this.setState({isConfirmationShowing:!0})}),w(this,"handleHideConfirmation",()=>{this.setState({isConfirmationShowing:!1},this.startTrayCloseTimer)})}componentDidMount(){this.setReactionButtonRect(),window.addEventListener("mouseover",this.setReactionButtonRect)}componentWillUnmount(){clearTimeout(this.trayOpenTimer),clearTimeout(this.trayCloseTimer),window.removeEventListener("mouseover",this.setReactionButtonRect)}render(){const{isReactionTrayShowing:e,reactionButtonRect:t,isConfirmationShowing:n,clickedReaction:o,useInitialReaction:r,isHoveringOverTray:s}=this.state,{reactionByMe:c,showTooltip:l}=this.props,d=r?c:o,u=d?x.b[d]:"default",{staticAsset:h,label:p}=Object(x.a)(u);return Object(i.jsxs)(a.e,{position:"relative",children:[Object(i.jsx)(j.a,{accessibilityLabel:"reaction",onClick:this.handleClickButton,onMouseEnter:this.handleOnHoverButton,onMouseLeave:this.handleOffHoverButton,style:{display:"block",border:"none",padding:0,cursor:"pointer",background:"transparent",outline:"none",borderRadius:"50%"},children:({active:e,hovered:t,focused:n})=>{let o={...C};return e?o={...C,...B}:t||s?o={...C,...I}:n&&(o={...C,...k}),Object(i.jsx)(a.e,{color:"transparent",rounding:"circle",dangerouslySetInlineStyle:{__style:o},children:Object(i.jsx)(a.e,{display:"flex",justifyContent:"center",alignItems:"center",dangerouslySetInlineStyle:{__style:{minHeight:44,minWidth:44}},children:Object(i.jsx)(a.e,{height:24,width:24,ref:this.reactionButtonRef,display:"flex",alignItems:"center",justifyContent:"center",dangerouslySetInlineStyle:{__style:{backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosiiton:"center",backgroundImage:`url(${h})`}}})})})}}),l&&!e&&!n&&r&&Object(i.jsx)(b.a,{experienceIds:[501977,501995],idealDirection:"down",placementId:12,anchor:this.reactionButtonRef.current,flyoutSize:"lg",onExperienceMount:this.handleExperienceMount}),e&&!!t&&!!t.left&&!!t.top&&Object(i.jsx)(a.e,{display:"flex",justifyContent:"center",alignItems:"center",children:Object(i.jsx)(a.Q,{top:0,children:Object(i.jsx)(a.V,{onMouseEnter:this.handleOnHoverTray,onMouseLeave:this.handleOffHoverTray,children:Object(i.jsx)(T,{reactionButtonRect:t,handleReactionTrayClick:this.setReaction})})})}),n&&!!d&&p&&Object(i.jsx)(g,{reactionLabel:p,handleHideConfirmation:this.handleHideConfirmation})]})}}var D=Object(r.connect)(null,e=>({pinUpdateReactionCount:(t,n,i)=>e(function(e,t,n){return{type:"PIN_UPDATE_REACTION_COUNT",payload:{id:e,increment:t,reactionType:n}}}(t,n,i))}))(E),H=n("rYoy"),P=n("zXAL"),F=n("T5j3"),M=n("/zJj");function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const A=Object(o.lazy)(()=>Promise.resolve().then(n.bind(null,"fepT")));class L extends o.Component{constructor(e){super(e),z(this,"sendExperienceComplete",()=>{}),z(this,"handleExternalSend",()=>{this.sendExperienceComplete()}),z(this,"onSendExperienceMount",e=>{e&&e.complete&&500946===e.experience_id&&(this.sendExperienceComplete=e.complete)}),z(this,"promoteButtonRef",Object(o.createRef)()),this.sendButtonTooltipRef=Object(o.createRef)()}render(){const{editable:e,goBack:t,gridDescription:n,hidePromoteButton:r,imageSrc:s,isFlyoutOpen:c,isOnSecretBoard:l,isPdp:d,onEditSubmit:u,onFlyoutDismiss:j,onToggleFlyout:f,pin:y,promoteButton:g,saveButton:O,shareButtonRef:x,showFavoriteButton:S,viewParameter:v}=this.props,R=l?null:Object(i.jsx)(H.a,{children:Object(i.jsxs)(a.e,{children:[Object(i.jsx)(a.e,{ref:this.sendButtonTooltipRef,children:Object(i.jsx)(A,{buttonType:"icon",gridDescription:n,imageSrc:s,isFlyoutOpen:c,onExternalSend:this.handleExternalSend,onFlyoutDismiss:j,onToggleFlyout:f,pinId:y.id,sendType:"pin",shareButtonRef:x})}),O&&!c&&Object(i.jsx)(b.a,{experienceIds:[500946],placementId:12,anchor:this.sendButtonTooltipRef.current,onExperienceMount:this.onSendExperienceMount})]})}),T=Object(F.c)(y),{board:_,favorited_by_me:w,section:C}=y,I=Object(i.jsxs)(a.e,{display:"flex",color:"white",justifyContent:"between",rounding:2,"data-test-id":"closeup-action-items",maxWidth:d?M.f:M.d,children:[Object(i.jsxs)(a.e,{display:"flex",children:[e&&!S&&Object(i.jsx)(a.e,{marginEnd:1,children:Object(i.jsx)(p.a,{carouselSlotCurrentIndex:y&&y.carousel_data&&y.carousel_data.index,pinId:y.id,onSubmit:u,view:3,viewParameter:v})}),Object(i.jsx)(a.e,{marginEnd:S?2:0,children:Object(i.jsx)(m.a,{carouselSlotCurrentIndex:y&&y.carousel_data&&y.carousel_data.index,goBack:t,onEditSubmit:u,pin:y,showEditPin:S,viewParameter:v})})]}),Object(i.jsxs)(a.r,{alignItems:"center",gap:S?2:0,children:[R,T&&Object(i.jsx)(H.a,{children:Object(i.jsx)(D,{pinId:y.id,reactionByMe:y.reaction_by_me,showTooltip:!0})}),S&&Object(i.jsx)(h,{board:_,favorited:!!w,pinId:y.id,section:C}),!r&&g&&Object(i.jsx)(H.a,{children:Object(i.jsxs)(o.Fragment,{children:[Object(i.jsx)(a.e,{ref:this.promoteButtonRef,children:g}),Object(i.jsx)(b.a,{experienceIds:[501121],idealDirection:"down",placementId:12,anchor:this.promoteButtonRef.current,flyoutSize:"lg"})]})})]})]});return Object(i.jsx)(o.Fragment,{children:Object(i.jsxs)(a.e,{display:"flex",justifyContent:"between",children:[I,Object(i.jsx)(a.e,{marginStart:3,children:O})]})})}}t.default=Object(P.a)(L)}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/js/CloseupActionBarCommon-71674d3c59737ae09a81.mjs.map